pipeline {
    agent any

    stages {
        stage('Checkout') {
            steps {
                git branch: 'main', url: 'https://github.com/chauhanpranay19/NewsWebsite.git'
            }
        }
       stage('SonarQube Analysis') {
    steps {
        script {
            // Get the SonarScanner installation
            def scannerHome = tool 'SonarQubeScanner' 
            echo "SonarQube Scanner Home: ${scannerHome}"

            // Fetch the SonarQube token from Jenkins credentials
            def sonarToken = credentials('a44ec19a-7f47-4877-863b-28a3ab6338db') // Replace with your actual credential ID
            
            withSonarQubeEnv('SonarQube server') { // Use the name of your SonarQube server configured in Jenkins
                bat "${scannerHome}\\sonar-scanner.bat -Dsonar.projectKey=my_org:NewsWebsite -Dsonar.projectName='News Website' -Dsonar.host.url=http://localhost:9000 -Dsonar.login=${sonarToken}"
            }
        }
    }
}

        stage('Test') {
            steps {
                echo 'Running tests...'
                // Here you can add your testing commands, if applicable
                // For example, if you have a JavaScript testing framework like Jest or Mocha:
                // bat 'npm test'
            }
        }
        stage('Deploy') {
            steps {
                echo 'Deploying the project...'
                // Add your deployment commands here
                // Example: bat 'aws s3 cp index.html s3://mybucket/' // For AWS S3 deployment
            }
        }
    }
}
